<!--
 ~ Copyright (c) 2005-2010, WSO2 Inc. (http://www.wso2.org) All Rights Reserved.
 ~
 ~ WSO2 Inc. licenses this file to you under the Apache License,
 ~ Version 2.0 (the "License"); you may not use this file except
 ~ in compliance with the License.
 ~ You may obtain a copy of the License at
 ~
 ~    http://www.apache.org/licenses/LICENSE-2.0
 ~
 ~ Unless required by applicable law or agreed to in writing,
 ~ software distributed under the License is distributed on an
 ~ "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
 ~ KIND, either express or implied.  See the License for the
 ~ specific language governing permissions and limitations
 ~ under the License.
 -->
<div style="background: #f8f8f8; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><table><tr><td><pre style="margin: 0; line-height: 125%"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81</pre></td><td><pre style="margin: 0; line-height: 125%"><span style="color: #008000; font-weight: bold">&lt;%@</span> page import<span style="color: #666666">=</span><span style="color: #BA2121">&quot;javax.cache.CacheManager&quot;</span> <span style="color: #008000; font-weight: bold">%&gt;</span>
<span style="color: #008000; font-weight: bold">&lt;%@</span> page import<span style="color: #666666">=</span><span style="color: #BA2121">&quot;javax.cache.Caching&quot;</span> <span style="color: #008000; font-weight: bold">%&gt;</span>
<span style="color: #008000; font-weight: bold">&lt;%@</span> page import<span style="color: #666666">=</span><span style="color: #BA2121">&quot;javax.cache.Cache&quot;</span> <span style="color: #008000; font-weight: bold">%&gt;</span>

<span style="color: #008000; font-weight: bold">&lt;h2&gt;</span>WSO2 Carbon Caching Demo<span style="color: #008000; font-weight: bold">&lt;/h2&gt;</span>

<span style="color: #008000; font-weight: bold">&lt;hr/&gt;</span>
<span style="color: #008000; font-weight: bold">&lt;p&gt;</span>

<span style="color: #008000; font-weight: bold">&lt;h3&gt;</span>Add to Cache<span style="color: #008000; font-weight: bold">&lt;/h3&gt;</span>

<span style="color: #008000; font-weight: bold">&lt;form</span> <span style="color: #7D9029">action=</span><span style="color: #BA2121">&quot;index.jsp&quot;</span> <span style="color: #7D9029">method=</span><span style="color: #BA2121">&quot;POST&quot;</span><span style="color: #008000; font-weight: bold">&gt;</span>
    <span style="color: #008000; font-weight: bold">&lt;table</span> <span style="color: #7D9029">border=</span><span style="color: #BA2121">&quot;0&quot;</span><span style="color: #008000; font-weight: bold">&gt;</span>
        <span style="color: #008000; font-weight: bold">&lt;tr&gt;</span>
            <span style="color: #008000; font-weight: bold">&lt;td&gt;</span>Key<span style="color: #008000; font-weight: bold">&lt;/td&gt;</span>
            <span style="color: #008000; font-weight: bold">&lt;td&gt;&lt;input</span> <span style="color: #7D9029">type=</span><span style="color: #BA2121">&quot;text&quot;</span> <span style="color: #7D9029">name=</span><span style="color: #BA2121">&quot;key&quot;</span><span style="color: #008000; font-weight: bold">/&gt;&lt;/td&gt;</span>
        <span style="color: #008000; font-weight: bold">&lt;/tr&gt;</span>
        <span style="color: #008000; font-weight: bold">&lt;tr&gt;</span>
            <span style="color: #008000; font-weight: bold">&lt;td&gt;</span>Value<span style="color: #008000; font-weight: bold">&lt;/td&gt;</span>
            <span style="color: #008000; font-weight: bold">&lt;td&gt;&lt;input</span> <span style="color: #7D9029">type=</span><span style="color: #BA2121">&quot;text&quot;</span> <span style="color: #7D9029">name=</span><span style="color: #BA2121">&quot;value&quot;</span><span style="color: #008000; font-weight: bold">/&gt;&lt;/td&gt;</span>
        <span style="color: #008000; font-weight: bold">&lt;/tr&gt;</span>
        <span style="color: #008000; font-weight: bold">&lt;tr&gt;</span>
            <span style="color: #008000; font-weight: bold">&lt;td&gt;</span><span style="color: #999999; font-weight: bold">&amp;nbsp;</span><span style="color: #008000; font-weight: bold">&lt;/td&gt;</span>
            <span style="color: #008000; font-weight: bold">&lt;td&gt;&lt;input</span> <span style="color: #7D9029">type=</span><span style="color: #BA2121">&quot;submit&quot;</span> <span style="color: #7D9029">value=</span><span style="color: #BA2121">&quot;Add&quot;</span> <span style="color: #7D9029">name=</span><span style="color: #BA2121">&quot;add&quot;</span><span style="color: #008000; font-weight: bold">&gt;&lt;/td&gt;</span>
        <span style="color: #008000; font-weight: bold">&lt;/tr&gt;</span>
    <span style="color: #008000; font-weight: bold">&lt;/table&gt;</span>
<span style="color: #008000; font-weight: bold">&lt;/form&gt;</span>
<span style="color: #008000; font-weight: bold">&lt;/p&gt;</span>
<span style="color: #008000; font-weight: bold">&lt;hr/&gt;</span>
<span style="color: #008000; font-weight: bold">&lt;p&gt;</span>

<span style="color: #008000; font-weight: bold">&lt;h3&gt;</span>Read from Cache<span style="color: #008000; font-weight: bold">&lt;/h3&gt;</span>

<span style="color: #008000; font-weight: bold">&lt;form</span> <span style="color: #7D9029">action=</span><span style="color: #BA2121">&quot;index.jsp&quot;</span> <span style="color: #7D9029">method=</span><span style="color: #BA2121">&quot;POST&quot;</span><span style="color: #008000; font-weight: bold">&gt;</span>
    <span style="color: #008000; font-weight: bold">&lt;table</span> <span style="color: #7D9029">border=</span><span style="color: #BA2121">&quot;0&quot;</span><span style="color: #008000; font-weight: bold">&gt;</span>
        <span style="color: #008000; font-weight: bold">&lt;tr&gt;</span>
            <span style="color: #008000; font-weight: bold">&lt;td&gt;</span>Key<span style="color: #008000; font-weight: bold">&lt;/td&gt;</span>
            <span style="color: #008000; font-weight: bold">&lt;td&gt;&lt;input</span> <span style="color: #7D9029">type=</span><span style="color: #BA2121">&quot;text&quot;</span> <span style="color: #7D9029">name=</span><span style="color: #BA2121">&quot;key&quot;</span><span style="color: #008000; font-weight: bold">/&gt;&lt;/td&gt;</span>
        <span style="color: #008000; font-weight: bold">&lt;/tr&gt;</span>
        <span style="color: #008000; font-weight: bold">&lt;tr&gt;</span>
            <span style="color: #008000; font-weight: bold">&lt;td&gt;</span><span style="color: #999999; font-weight: bold">&amp;nbsp;</span><span style="color: #008000; font-weight: bold">&lt;/td&gt;</span>
            <span style="color: #008000; font-weight: bold">&lt;td&gt;&lt;input</span> <span style="color: #7D9029">type=</span><span style="color: #BA2121">&quot;submit&quot;</span> <span style="color: #7D9029">value=</span><span style="color: #BA2121">&quot;View&quot;</span> <span style="color: #7D9029">name=</span><span style="color: #BA2121">&quot;view&quot;</span><span style="color: #008000; font-weight: bold">&gt;&lt;/td&gt;</span>
        <span style="color: #008000; font-weight: bold">&lt;/tr&gt;</span>
    <span style="color: #008000; font-weight: bold">&lt;/table&gt;</span>
<span style="color: #008000; font-weight: bold">&lt;/form&gt;</span>
<span style="color: #008000; font-weight: bold">&lt;/p&gt;</span>
<span style="color: #008000; font-weight: bold">&lt;hr/&gt;</span>

<span style="color: #008000; font-weight: bold">&lt;%</span>
    <span style="color: #408080; font-style: italic">// The javax.cache.CacheManager instance used to obtain the cache</span>
    CacheManager cacheManager <span style="color: #666666">=</span>   Caching<span style="color: #666666">.</span><span style="color: #7D9029">getCacheManagerFactory</span><span style="color: #666666">().</span><span style="color: #7D9029">getCacheManager</span><span style="color: #666666">(</span><span style="color: #BA2121">&quot;tsampleCacheManager&quot;</span><span style="color: #666666">);</span>
    Cache<span style="color: #666666">&lt;</span>String<span style="color: #666666">,</span> String<span style="color: #666666">&gt;</span> cache <span style="color: #666666">=</span> cacheManager<span style="color: #666666">.</span><span style="color: #7D9029">getCache</span><span style="color: #666666">(</span><span style="color: #BA2121">&quot;sampleCache&quot;</span><span style="color: #666666">);</span>

    <span style="color: #008000; font-weight: bold">if</span> <span style="color: #666666">(</span>request<span style="color: #666666">.</span><span style="color: #7D9029">getParameter</span><span style="color: #666666">(</span><span style="color: #BA2121">&quot;add&quot;</span><span style="color: #666666">)</span> <span style="color: #666666">!=</span> <span style="color: #008000; font-weight: bold">null</span><span style="color: #666666">)</span> <span style="color: #666666">{</span>
        String key <span style="color: #666666">=</span> request<span style="color: #666666">.</span><span style="color: #7D9029">getParameter</span><span style="color: #666666">(</span><span style="color: #BA2121">&quot;key&quot;</span><span style="color: #666666">);</span>
        String value <span style="color: #666666">=</span> request<span style="color: #666666">.</span><span style="color: #7D9029">getParameter</span><span style="color: #666666">(</span><span style="color: #BA2121">&quot;value&quot;</span><span style="color: #666666">);</span>
        cache<span style="color: #666666">.</span><span style="color: #7D9029">put</span><span style="color: #666666">(</span>key<span style="color: #666666">,</span> value<span style="color: #666666">);</span>
<span style="color: #008000; font-weight: bold">%&gt;</span>
<span style="color: #008000; font-weight: bold">&lt;p&gt;</span>
    Added entry: <span style="color: #008000; font-weight: bold">&lt;%=</span> key <span style="color: #008000; font-weight: bold">%&gt;</span>
<span style="color: #008000; font-weight: bold">&lt;/p&gt;</span>
<span style="color: #008000; font-weight: bold">&lt;%</span>
    <span style="color: #666666">}</span> <span style="color: #008000; font-weight: bold">else</span> <span style="color: #008000; font-weight: bold">if</span> <span style="color: #666666">(</span>request<span style="color: #666666">.</span><span style="color: #7D9029">getParameter</span><span style="color: #666666">(</span><span style="color: #BA2121">&quot;view&quot;</span><span style="color: #666666">)</span> <span style="color: #666666">!=</span> <span style="color: #008000; font-weight: bold">null</span><span style="color: #666666">)</span> <span style="color: #666666">{</span>
        String key <span style="color: #666666">=</span> request<span style="color: #666666">.</span><span style="color: #7D9029">getParameter</span><span style="color: #666666">(</span><span style="color: #BA2121">&quot;key&quot;</span><span style="color: #666666">);</span>
        <span style="color: #008000; font-weight: bold">if</span> <span style="color: #666666">(</span>cache<span style="color: #666666">.</span><span style="color: #7D9029">get</span><span style="color: #666666">(</span>key<span style="color: #666666">)</span> <span style="color: #666666">!=</span> <span style="color: #008000; font-weight: bold">null</span><span style="color: #666666">)</span> <span style="color: #666666">{</span>
            String content <span style="color: #666666">=</span> <span style="color: #666666">(</span>String<span style="color: #666666">)</span> cache<span style="color: #666666">.</span><span style="color: #7D9029">get</span><span style="color: #666666">(</span>key<span style="color: #666666">);</span>
            response<span style="color: #666666">.</span><span style="color: #7D9029">addHeader</span><span style="color: #666666">(</span><span style="color: #BA2121">&quot;cache-value&quot;</span><span style="color: #666666">,</span> content<span style="color: #666666">);</span>
<span style="color: #008000; font-weight: bold">%&gt;</span>
            <span style="color: #008000; font-weight: bold">&lt;p&gt;</span>
                Value of entry <span style="color: #008000; font-weight: bold">&lt;%=</span> key<span style="color: #008000; font-weight: bold">%&gt;</span> : <span style="color: #008000; font-weight: bold">&lt;%=</span> content <span style="color: #008000; font-weight: bold">%&gt;</span>
            <span style="color: #008000; font-weight: bold">&lt;/p&gt;</span>
<span style="color: #008000; font-weight: bold">&lt;%</span>
        <span style="color: #666666">}</span> <span style="color: #008000; font-weight: bold">else</span> <span style="color: #666666">{</span>
<span style="color: #008000; font-weight: bold">%&gt;</span>
            <span style="color: #008000; font-weight: bold">&lt;p&gt;</span>
                Unable to find an entry by the given key <span style="color: #008000; font-weight: bold">&lt;%=</span> key<span style="color: #008000; font-weight: bold">%&gt;</span>!
            <span style="color: #008000; font-weight: bold">&lt;/p&gt;</span>
<span style="color: #008000; font-weight: bold">&lt;%</span>
        <span style="color: #666666">}</span>
    <span style="color: #666666">}</span>
<span style="color: #008000; font-weight: bold">%&gt;</span>
</pre></td></tr></table></div>
